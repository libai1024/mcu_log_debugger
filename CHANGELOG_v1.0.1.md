# MCU Log Debugger - v1.0.1 更新日志

## 🎉 新功能

### 1. 新消息动画效果 ✨
- **淡入滑动动画**：新消息从左侧滑入并淡入显示（400ms）
- **级别颜色区分**：
  - ERROR：浅红色高亮 + 红色左边框
  - WARN：浅黄色高亮 + 黄色左边框
  - INFO：浅绿色高亮 + 绿色左边框
  - 其他：浅蓝色高亮
- **平滑过渡**：使用弹性缓动函数，视觉效果柔和
- **性能优化**：CSS3 硬件加速，不影响性能
- **全模式支持**：Log/HEX/Normal 三种模式都支持动画

### 2. 多模式显示切换 🔄
- **Log 模式**：结构化日志显示，支持时间戳、级别、Tag、消息等列
- **HEX 模式**：十六进制数据查看
  - 地址偏移显示（每16字节一行）
  - HEX 数据分组显示（每8字节一组）
  - ASCII 对照显示（可打印字符显示，不可打印显示为 `.`）
- **Normal 模式**：纯文本终端风格显示
- 快捷键支持：
  - `Cmd/Ctrl + 1`：切换到 Log 模式
  - `Cmd/Ctrl + 2`：切换到 HEX 模式
  - `Cmd/Ctrl + 3`：切换到 Normal 模式
- 模式切换器带动画指示器

### 2. 视图锁定功能 🔒
- **自动锁定触发场景**：
  - 搜索关键词时自动锁定
  - 关闭自动滚动时锁定
  - 用户手动向上滚动时锁定
- **手动锁定**：
  - 工具栏锁定按钮
  - 快捷键：`Cmd/Ctrl + L`
- **锁定通知卡片**：
  - 显示锁定原因（搜索中/手动浏览/已锁定）
  - 实时显示累积的新消息数量
  - 一键解锁按钮
- **锁定期间行为**：
  - 消息列表保持静止，不滚动
  - 新消息累积计数
  - 解锁后自动恢复正常行为

### 3. VSCode 风格搜索高亮 🔍
- **双层高亮系统**：
  - 所有匹配项：浅黄色背景高亮
  - 当前匹配项：深黄色背景 + 加粗 + 脉冲动画
- **智能导航**：
  - 上一个/下一个按钮
  - Enter/Shift+Enter 快捷键
  - 自动滚动到当前匹配项
- **实时计数**：显示 "3/15" 格式的匹配位置
- **视觉引导**：脉冲动画吸引注意到当前项
- **主题适配**：浅色/深色主题自动调整高亮颜色

### 4. 设置入口优化 ⚙️
- 设置按钮从侧边栏底部移至右上角标题栏
- 与主题切换按钮并列显示
- 更符合主流应用的交互习惯

## 🎨 UI/UX 改进

### 动画效果
- 新消息淡入滑动动画
- 级别颜色高亮区分
- 左侧彩色边框提示（ERROR/WARN/INFO）
- 平滑的弹性缓动效果

### 交互优化
- 单击消息行即可高亮选中
- 点击其他行自动切换选中状态
- 选中效果：蓝色边框高亮

### 工具栏优化
- 新增模式切换器组件
- 新增视图锁定按钮
- 移除重复的 HEX 模式按钮
- 工具栏分隔符优化
- 按钮图标和提示文字优化

### HEX 模式显示优化
- 专业的十六进制查看器布局
- 地址、HEX 数据、ASCII 三列对齐
- 颜色区分不同部分
- 等宽字体确保对齐

### 视图锁定通知
- 优雅的卡片式通知
- 滑入动画效果
- 实时更新的消息计数器
- 清晰的锁定原因提示

## 🔧 技术改进

### 代码重构
- `renderLogTable()` 函数重构，支持三种显示模式
- 新增 `renderLogMode()`、`renderHexMode()`、`renderNormalMode()` 函数
- 新增 `lockView()`、`unlockView()`、`toggleViewLock()` 函数
- 新增 `stringToHexFormatted()` 函数用于格式化 HEX 显示

### 状态管理
- 新增 `displayMode` 全局状态（'log' | 'hex' | 'normal'）
- 新增 `isViewLocked` 全局状态
- 新增 `lockReason` 全局状态（'search' | 'scroll' | 'manual'）
- 新增 `pendingMessageCount` 全局状态
- 模式和锁定状态持久化到 localStorage

### 事件处理优化
- 搜索时自动触发视图锁定
- 滚动监听优化，支持锁定/解锁
- 自动滚动开关联动视图锁定
- 键盘快捷键支持

## 📝 配置文件

### MODE_CONFIG
```javascript
{
    log: { name: 'Log', icon: 'fa-list-ul', description: '结构化日志显示', shortcut: '1' },
    hex: { name: 'HEX', icon: 'fa-code', description: '十六进制数据查看', shortcut: '2' },
    normal: { name: 'Normal', icon: 'fa-terminal', description: '纯文本终端风格', shortcut: '3' }
}
```

### LOCK_REASON
```javascript
{
    search: { icon: 'fa-search', text: '搜索中' },
    scroll: { icon: 'fa-hand-paper', text: '手动浏览' },
    manual: { icon: 'fa-lock', text: '已锁定' }
}
```

## 🐛 Bug 修复
- 修复搜索时滚动位置跳动问题（通过视图锁定解决）
- 修复新消息到达时打断用户浏览的问题（通过视图锁定解决）
- 优化 HEX 模式显示格式

## 📚 文档更新
- 更新 `README.md`，添加 v1.0.1 功能说明
- 创建 `docs/v1.0.1/` 目录，包含：
  - `ROADMAP.md`：开发路线图
  - `FEATURE_REVIEW.md`：功能评审文档
  - `UI_IMPROVEMENTS.md`：UI/UX 改进设计
  - `TECHNICAL_DETAILS.md`：技术实现细节
  - `VIEW_LOCK_FEATURE.md`：视图锁定功能设计

## 🚀 性能优化
- 视图锁定期间减少不必要的渲染
- HEX 模式优化大数据量显示

## 📦 兼容性
- 完全向后兼容 v1.0.0
- 保留所有现有功能
- 新增功能不影响原有工作流

## 🎯 下一步计划（Week 2）
- [ ] 全面测试三种模式切换
- [ ] 测试视图锁定各种触发场景
- [ ] 性能测试和优化
- [ ] 用户体验微调
- [ ] 文档完善
- [ ] 准备发布

---

**发布日期**：待定  
**开发周期**：2 周  
**版本状态**：开发完成，待测试
